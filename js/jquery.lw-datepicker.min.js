(function(){var c,k,l,m,d=function(b,a){return function(){return b.apply(a,arguments)}};c=jQuery;m={multiple:false,onChange:null,firstDayOfTheWeekIndex:1,autoFillToday:false,parseDate:null,formatDate:null,startDate:null,endDate:null,dowNames:"sun,mon,tue,wed,thu,fri,sat".split(","),monthNames:"January,February,March,April,May,June,July,August,September,October,November,December".split(",")};l=function(b,a){return b.getFullYear()!==a.getFullYear()?false:b.getMonth()!==a.getMonth()?false:b.getDate()===
a.getDate()};k=function(){function b(a){this.handleKeyUp=d(this.handleKeyUp,this);this.changeDay=d(this.changeDay,this);this.changeMonth=d(this.changeMonth,this);this.bindTo=d(this.bindTo,this);this.show=d(this.show,this);this.hide=d(this.hide,this);this.updateMonth=d(this.updateMonth,this);this.settings=a;this.todayDate=new Date;this.currentDate=new Date;this.wrapper=c('<div class="lw-dp"/>');this.toolbar=c('<div class="lw-dp-toolbar"/>').appendTo(this.wrapper);this.previous=c('<div class="lw-dp-previous">\u25c4</div>').appendTo(this.toolbar);
this.next=c('<div class="lw-dp-next">\u25ba</div>').appendTo(this.toolbar);this.month=c('<div class="lw-dp-month"/>').appendTo(this.toolbar);this.renderDows().appendTo(this.wrapper);this.days=c("<div />").appendTo(this.wrapper);this.next.bind("click",d(function(){return this.onNextClick()},this));this.previous.bind("click",d(function(){return this.onPreviousClick()},this));this.updateMonth();this.wrapper.bind("mousedown",function(){return false});c(this.days).delegate("li:not(.lw-dp-active-day)",
"click",d(function(a){this.selectDay(c(a.currentTarget));return false},this));this.wrapper.appendTo(document.body);this.hide()}b.prototype.currentInput=null;b.prototype.activeDate=null;b.prototype.canSelectPreviousMonth=true;b.prototype.canSelectNextMonth=true;b.prototype.selectDay=function(a){var f,b,c,d;d=this.currentDate.getFullYear();c=this.currentDate.getMonth();f=parseInt(a.text());b=0;a.hasClass("lw-dp-neighbour-month-day")&&(b=f>10?-1:1);f=new Date(d,c+b,f);if(this.settings.startDate==null||
f.getTime()>=this.settings.startDate.getTime())if(this.settings.endDate==null||f.getTime()<=this.settings.endDate.getTime())a.parent().parent().find("li").removeClass("lw-dp-active-day"),a.addClass("lw-dp-active-day"),this.activeDate=f,b!==0&&this.updateMonth(b);this.updateInput();if(typeof this.settings.onChange==="function")return this.settings.onChange(this.currentInput,this.activeDate)};b.prototype.updateInput=function(){return this.currentInput.val(this.formatDate(this.activeDate))};b.prototype.parseDate=
function(a){return typeof this.settings.parseDate==="function"?this.settings.parseDate(a):new Date(Date.parse(a))};b.prototype.formatDate=function(a){return typeof this.settings.formatDate==="function"?this.settings.formatDate(a):a.getMonth()+1+"/"+a.getDate()+"/"+a.getFullYear()};b.prototype.onNextClick=function(){return this.updateMonth(1)};b.prototype.onPreviousClick=function(){return this.updateMonth(-1)};b.prototype.updateMonth=function(a){var f,b,e,j,i,g,h;a==null&&(a=0);this.currentDate.setMonth(this.currentDate.getMonth()+
a);this.month.html(this.settings.monthNames[this.currentDate.getMonth()]+", "+this.currentDate.getFullYear());f=this.currentDate;a=new Date(f.getFullYear(),f.getMonth(),0);this.settings.startDate!=null&&a.getTime()<this.settings.startDate.getTime()?(this.canSelectPreviousMonth=false,c(this.previous).hide()):(this.canSelectPreviousMonth=true,c(this.previous).show());b=new Date(f.getFullYear(),f.getMonth()+1,1);this.settings.endDate!=null&&b.getTime()>this.settings.endDate.getTime()?(this.canSelectNextMonth=
false,c(this.next).hide()):(this.canSelectNextMonth=true,c(this.next).show());b=(new Date(f.getFullYear(),f.getMonth(),1)).getDay();j=(this.settings.firstDayOfTheWeekIndex+6)%7;b=(7-b+this.settings.firstDayOfTheWeekIndex)%7;b===0&&(b=7);a.getDate();a=new Date(f.getFullYear(),f.getMonth(),b-6);e=(new Date(f.getFullYear(),f.getMonth()+1,0)).getDate();h=Math.ceil((e+7-b)/7);i=d(function(a){var b,c,e;c=[];b="";e=a.getDate();a.getMonth()!==f.getMonth()&&c.push("lw-dp-neighbour-month-day");(a.getDay()===
0||a.getDay()===6)&&c.push("lw-dp-weekend");a.getDay()===j&&c.push("lw-dp-week-last-column");l(a,this.todayDate)&&(c.push("lw-dp-today"),e="<span>"+e+"</span>");this.activeDate!=null&&l(a,this.activeDate)&&c.push("lw-dp-active-day");this.settings.startDate&&a.getTime()<=this.settings.startDate.getTime()&&(c.push("lw-dp-out-of-interval"),e="");this.settings.endDate&&a.getTime()>=this.settings.endDate.getTime()&&(c.push("lw-dp-out-of-interval"),e="");c.length&&(b=" class='"+c.join(" ")+"'");a.setDate(a.getDate()+
1);return"<li"+b+">"+e+"</li>"},this);e="";for(g=1;1<=h?g<=h:g>=h;1<=h?g++:g--){e+=g===1?'<ul class="lw-dp-week lw-dp-firstweek">':g===h?'<ul class="lw-dp-week lw-dp-lastweek">':'<ul class="lw-dp-week">';for(b=1;b<=7;b++)e+=i(a);e+="</ul>"}return this.days.html(e)};b.prototype.renderDows=function(){var a,b,d,e,j,i,g,h;b=this.settings.dowNames[this.settings.firstDayOfTheWeekIndex];d=false;e='<ul class="lw-dp-dows">';j="";h=this.settings.dowNames;for(i=0,g=h.length;i<g;i++)a=h[i],a===b&&(d=true),a=
"<li>"+a+"</li>",d?e+=a:j+=a;e+=j;e+="</ul>";return c(e)};b.prototype.hide=function(a){c(this.wrapper).addClass("lw-dp-hidden");if(a!=null)return this.saveData(c(a.currentTarget))};b.prototype.show=function(a){c(this.wrapper).removeClass("lw-dp-hidden");a!=null&&(a=c(a.currentTarget).data("lw-datepicker"),c.extend(this,a));return this.updateMonth()};b.prototype.isDateValid=function(a){return Object.prototype.toString.call(a)!=="[object Date]"?false:!isNaN(a.getTime())};b.prototype.saveData=function(a){var b;
b=this.parseDate(a.val());if(this.isDateValid(b))this.currentDate=new Date(b.getTime()),this.activeDate=new Date(b.getTime());return a.data("lw-datepicker",{activeDate:this.activeDate,currentDate:new Date(this.currentDate.getTime()),currentInput:a})};b.prototype.bindTo=function(a){a=c(a);a.bind("focus",this.show);a.bind("blur",this.hide);a.bind("change",d(function(a){this.saveData(c(a.currentTarget));return this.updateMonth()},this));a.bind("keyup",this.handleKeyUp);return this.saveData(a)};b.prototype.changeMonth=
function(){var a,b,d;if(this.activeDate!=null)return b=this.activeDate.getDate()-1,a=new Date(this.activeDate.getTime()),a.setMonth(this.currentDate.getMonth()),a.setFullYear(this.currentDate.getFullYear()),d=c(this.days).find("li:not(.lw-dp-neighbour-month-day)"),d.length<=b?d.last().click():this.settings.endDate!=null&&a.getTime()>this.settings.endDate.getTime()?d.eq(this.settings.endDate.getDate()-2).click():this.settings.startDate!=null&&a.getTime()<this.settings.startDate.getTime()?d.eq(this.settings.startDate.getDate()).click():
d.eq(b).click()};b.prototype.changeDay=function(a){var b,d,e;e=a==="prev"?"last":"first";return this.activeDate!=null?(b=c(this.days).find("li.lw-dp-active-day"),d=b[a](),d.length?d.click():b.parent()[a]().children()[e]().click()):c(this.days).find("li.lw-dp-today").click()};b.prototype.handleKeyUp=function(a){switch(a.keyCode){case 33:this.canSelectPreviousMonth&&(this.onPreviousClick(),this.changeMonth());break;case 34:this.canSelectNextMonth&&(this.onNextClick(),this.changeMonth());break;case 38:this.changeDay("prev");
break;case 40:this.changeDay("next")}return this.updateMonth};return b}();c.fn.lwDatepicker=function(b){var a,b=c.extend(m,b);a=null;return this.each(function(){var d;if(c(this).is("input, textarea"))return b.multiple?(d=new k(b),d.bindTo(this)):(a||(a=new k(b)),a.bindTo(this))})}}).call(this);
